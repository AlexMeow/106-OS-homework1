<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=big5">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 14">
<meta name=Originator content="Microsoft Word 14">
<link rel=File-List href="index.files/filelist.xml">
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>бебе</o:Author>
  <o:LastAuthor>бебе</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>818</o:TotalTime>
  <o:Created>2017-10-15T05:23:00Z</o:Created>
  <o:LastSaved>2017-10-15T05:23:00Z</o:LastSaved>
  <o:Pages>17</o:Pages>
  <o:Words>2926</o:Words>
  <o:Characters>16679</o:Characters>
  <o:Lines>138</o:Lines>
  <o:Paragraphs>39</o:Paragraphs>
  <o:CharactersWithSpaces>19566</o:CharactersWithSpaces>
  <o:Version>14.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:RelyOnVML/>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="index.files/themedata.thmx">
<link rel=colorSchemeMapping href="index.files/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:PunctuationKerning/>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>EN-US</w:LidThemeOther>
  <w:LidThemeAsian>ZH-TW</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:AdjustLineHeightInTable/>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
   <w:UseFELayout/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="true"
  DefSemiHidden="true" DefQFormat="false" DefPriority="99"
  LatentStyleCount="267">
  <w:LsdException Locked="false" Priority="0" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" Name="toc 9"/>
  <w:LsdException Locked="false" Priority="35" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" Priority="10" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" Priority="1" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" Priority="11" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" Priority="22" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" Priority="59" SemiHidden="false"
   UnhideWhenUsed="false" Name="Table Grid"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" UnhideWhenUsed="false" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" SemiHidden="false"
   UnhideWhenUsed="false" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" SemiHidden="false"
   UnhideWhenUsed="false" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" SemiHidden="false"
   UnhideWhenUsed="false" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" SemiHidden="false"
   UnhideWhenUsed="false" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" SemiHidden="false"
   UnhideWhenUsed="false" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" QFormat="true" Name="TOC Heading"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:╥s╡с╘ЗеИ;
	panose-1:2 2 5 0 0 0 0 0 0 0;
	mso-font-alt:PMingLiU;
	mso-font-charset:136;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1610611969 684719354 22 0 1048577 0;}
@font-face
	{font-family:╥s╡с╘ЗеИ;
	panose-1:2 2 5 0 0 0 0 0 0 0;
	mso-font-alt:PMingLiU;
	mso-font-charset:136;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1610611969 684719354 22 0 1048577 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-536859905 -1073732485 9 0 511 0;}
@font-face
	{font-family:"\@╥s╡с╘ЗеИ";
	panose-1:2 2 5 0 0 0 0 0 0 0;
	mso-font-charset:136;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-1610611969 684719354 22 0 1048577 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:12.0pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:╥s╡с╘ЗеИ;
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"╣Ы╦я╓Е╕r ╕r╓╦";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:12.0pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:╥s╡с╘ЗеИ;
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;}
span.MsoCommentReference
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:╣Ы╦я╓Е╕r;
	mso-style-link:"╣Ы╦я╔D╕╝ ╕r╓╦";
	mso-style-next:╣Ы╦я╓Е╕r;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:12.0pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:╥s╡с╘ЗеИ;
	mso-fareast-theme-font:minor-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-link:"╣Ы╦я╓Х╤Т╓Е╕r ╕r╓╦";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:none;
	font-size:9.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:╥s╡с╘ЗеИ;
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	mso-font-kerning:1.0pt;}
span.a
	{mso-style-name:"╣Ы╦я╓Е╕r ╕r╓╦";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:╣Ы╦я╓Е╕r;}
span.a0
	{mso-style-name:"╣Ы╦я╔D╕╝ ╕r╓╦";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-parent:"╣Ы╦я╓Е╕r ╕r╓╦";
	mso-style-link:╣Ы╦я╔D╕╝;
	font-weight:bold;}
span.a1
	{mso-style-name:"╣Ы╦я╓Х╤Т╓Е╕r ╕r╓╦";
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:╣Ы╦я╓Х╤Т╓Е╕r;
	mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	font-family:"Cambria","serif";
	mso-ascii-font-family:Cambria;
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:╥s╡с╘ЗеИ;
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Cambria;
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-family:"Calibri","sans-serif";
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;
	layout-grid:18.0pt;}
div.WordSection1
	{page:WordSection1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:╙М╝Ф╓╨╓Е;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Calibri","sans-serif";
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=ZH-TW style='tab-interval:24.0pt;text-justify-trim:punctuation'>

<div class=WordSection1 style='layout-grid:18.0pt'>

<p class=MsoNormal><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╖@╥~╗t╡нЁЬ╖i</span></p>

<p class=MsoNormal><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔|╦Й╓u╓T</span><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp; </span><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>B10415024<span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>
<span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;</span><span style='mso-tab-count:
1'>&nbsp; </span></span><span class=GramE><span style='text-fit:36.0pt;
mso-text-fit-id:1516612864'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin;mso-font-kerning:0pt'>╧Ы╞\</span></span></span><span
style='text-fit:36.0pt;mso-text-fit-id:1516612864'><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin;mso-font-kerning:0pt'>╖║</span></span></p>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span class=SpellE><b style='mso-bidi-font-weight:normal'><span
lang=EN-US style='font-size:14.0pt;mso-bidi-font-size:11.0pt'>Chaper</span></b></span><b
style='mso-bidi-font-weight:normal'><span lang=EN-US style='font-size:14.0pt;
mso-bidi-font-size:11.0pt'> 2<o:p></o:p></span></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span lang=EN-US
style='font-size:14.0pt;mso-bidi-font-size:11.0pt'><o:p>&nbsp;</o:p></span></b></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span lang=EN-US>Page
tables<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Page tables</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╛O╖@╥~╗t╡н╠╠╗Н╟O╬пеИ╕Л╖}╙╨╬В╗Н║C╔╕╜л╓╧Ё\</span><span lang=EN-US>xv6</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕b╓@╜с╧ЙеИ╟O╬пеИ╓W╕Ё╕h╜с╓ё╕P</span><span
lang=EN-US>process</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨╟O╬пеИ╙е╤║║A╘M╔h╚Oе@╓ё╕P</span><span lang=EN-US>process</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╙╨╟O╬пеИ║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╟t╧О</span><span
lang=EN-US>kernel</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╛ш╕P╙╨╟O╬пеИ╕b╚э╕h╙╨╟O╬пеИ╙е╤║║A╟t╧О╕h╘С╓@╜с╙╨╛ш╕P╙╨╟O╬пеИ╕b╓@╜с╟O╬пеИ╙е╤║║A╔н╓@╜с╗S╟t╧О╙╨</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╚Oе@╓@╜с╗о╔н╙л╟Ое|║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span lang=EN-US>Paging
hardware<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>X86</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╚Э╔O╬ч╖@╣Йюю╕a╖}║C╬В╬╧╙╨</span><span lang=EN-US>RAM</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╘н╛O╧ЙеИ╟O╬пеИЁQ╧ЙеИ╕a╖}╞а╓ч║C</span><span
lang=EN-US>X86 page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╣wеИЁs╠╣╗Б╨ь╕a╖}║Aбг╔я╟t╧О╗C╓@╜с╣Йюю╕a╖}╗Л╝и╕a╖}║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓@╜с</span><span
lang=EN-US>x86 page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╛O</span><span lang=EN-US>2^20 (1,048,576)
page table entries(PTEs)</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>║C╗C╓@╜с</span><span lang=EN-US>PTE</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔]╖t╓@╜с</span><span
lang=EN-US>20bits</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╧ЙеИ</span><span lang=EN-US>page number(PPN)</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╘M╓@╗г╨X╪m║CЁo╜с</span><span
lang=EN-US>paging</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╣wеИбг╔я╔╕╙╨╚e</span><span lang=EN-US>20bits</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╗Л</span><span
lang=EN-US>page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔h╢M╖Д</span><span lang=EN-US>PTE</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╗сб╫д╤╓@╜с╣Йюю╕a╖}║A╘M╗З╔N╕a╖}╙╨╚e</span><span
lang=EN-US>20bis</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╘M╕b</span><span lang=EN-US>PTE</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╙╨</span><span lang=EN-US>PPN</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║C</span><span
lang=EN-US>Page </span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╣wеИ╠q╣Йюю╗Лб╫д╤╙╨╧ЙеИ╕a╖}╓ёеэ╕a╫ф╩s╚А╜╠</span><span lang=EN-US>12bits</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║C╕]╕╧</span><span
lang=EN-US>page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╣╧╖@╥~╗t╡н╠╠╗Н╕b╣Йюю╗Л╧ЙеИ╕a╖}б╫д╤╕b╧О╩Т╙╨╡и╚в</span><span lang=EN-US>4096bytes</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╙╨</span><span
lang=EN-US>chunks</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C╗C╓@╜с</span><span lang=EN-US>chunk</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╨ы╛╟╓@╜с</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓@╜с</span><span
lang=EN-US>page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╧Ё╗Б╪h╬ПЁQюx╕s╕b╧ЙеИ╟O╬пеИ║C╬П╙╨╝з╛O╓@╜с</span><span lang=EN-US>4096bytes</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╙╨</span><span
lang=EN-US>page directory</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╔]╖t</span><span lang=EN-US>1024 PTE-like </span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓ч╔н╗Л</span><span
lang=EN-US>page table pages</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>║C╗C╓@╜с</span><span lang=EN-US>page table page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╛O╓@╜с</span><span
lang=EN-US>1024 32bits PTEs</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╙╨╟}╕C║C</span><span lang=EN-US>Paging</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╣wеИ╗о╔н╣Йюю╕a╖}╙╨╚e</span><span
lang=EN-US>10bits</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔h©О╬э╓@╜с</span><span lang=EN-US>PTE</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╠q</span><span lang=EN-US>page table
page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╛O</span><span
lang=EN-US>page directory</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╓ч╔н║C╕p╙G╓ё╛O</span><span lang=EN-US>page directory</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╤i╓J╓]╓ё╛O</span><span
lang=EN-US>PTE</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║A</span><span lang=EN-US>paging </span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╣wеИЁy╕╗╓@╜с©Ы╩~║CЁo╜с╗Б╪h╙╨╣╡╨c╓╧Ё\╓@╜с</span><span
lang=EN-US>page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔h╘©╡╓╔ЧЁ║╙╨</span><span lang=EN-US>page table pages</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕b╠`╨A╓j╫dЁР╙╨╣Йюю╟O╬пеИ╗S╕Ё╟t╧О║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╗C<span
class=GramE>╜с</span></span><span lang=EN-US>PTE</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔]╖t╨X╪m╙╨</span><span lang=EN-US>bit</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╗с╖i╤D</span><span
lang=EN-US>paging</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╣wеИ╕p╕С╛шцЖ╣Йюю╕a╖}ЁQ╓╧Ё\╗о╔н║C</span><span lang=EN-US>PTE_P</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╚Э╛O╖_</span><span
lang=EN-US>PTE</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╛O╥М╓U║G╕p╙G╔╕╗S╕ЁЁ]╘w║A╓@╜с╟я╕р╗Л</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>Ёy╕╗╓@╜с©Ы╩~║C</span><span
lang=EN-US>PTE_W</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╠╠╗Н╚Э╔O╛O╖_ЁQ╓╧Ё\╔h╪g╓J</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║F╕p╙G╗S╕ЁЁ]╘w║A╔u╕Ёе╙╘M╗З╚Э╔OЁQ╓╧Ё\║C</span><span
lang=EN-US>PTE_U</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╠╠╗Н╗о╔н╙л╣{╕║╛O╖_╓╧Ё\╔h╗о╔н</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║F╕p╙G<span
class=GramE>╡M╥║║A</span>╔u╕Ё</span><span lang=EN-US>kernel</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>ЁQ╓╧Ё\╔h╗о╔н</span><span
lang=EN-US>Page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C╨X╪п╘M╘р╕Ё╗Д╔L</span><span lang=EN-US>page</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╣wеИ╛шцЖ╣╡╨cЁQ╘w╦q╕b</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>Mmu.h</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>0700):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>//</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>юи╝в╔]╖t╘w╦q</span><span lang=EN-US>x86</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╟O╬пеИ╨ч╡zЁФ╓╦</span><span
lang=EN-US>(MMU)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// <span class=SpellE>Eflags</span> register</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_CF 0x00000001 // Carry Flag</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_PF 0x00000004 // Parity Flag</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_AF 0x00000010 // Auxiliary carry Flag</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_ZF 0x00000040 // Zero Flag</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_SF 0x00000080 // Sign Flag</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_TF 0x00000100 // Trap Flag</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_IF 0x00000200 // Interrupt Enable</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_DF 0x00000400 // Direction Flag</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_OF 0x00000800 // Overflow Flag</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_IOPL_MASK 0x00003000 // I/O Privilege
Level bitmask</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_IOPL_0 0x00000000 // IOPL == 0</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_IOPL_1 0x00001000 // IOPL == 1</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_IOPL_2 0x00002000 // IOPL == 2</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_IOPL_3 0x00003000 // IOPL == 3</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_NT 0x00004000 // Nested Task</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_RF 0x00010000 // Resume Flag</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_VM 0x00020000 // Virtual 8086 mode</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_AC 0x00040000 // Alignment Check</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_VIF 0x00080000 // Virtual Interrupt Flag</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_VIP 0x00100000 // Virtual Interrupt
Pending</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define FL_ID 0x00200000 // ID flag</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Control Register flags</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR0_PE 0x00000001 // Protection Enable</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR0_MP 0x00000002 // Monitor <span
class=SpellE>coProcessor</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR0_EM 0x00000004 // Emulation</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR0_TS 0x00000008 // Task Switched</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR0_ET 0x00000010 // Extension Type</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR0_NE 0x00000020 // Numeric <span
class=SpellE>Errror</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR0_WP 0x00010000 // Write Protect</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR0_AM 0x00040000 // Alignment Mask</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR0_NW 0x20000000 // Not <span class=SpellE>Writethrough</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR0_CD 0x40000000 // Cache Disable</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR0_PG 0x80000000 // Paging</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define CR4_PSE 0x00000010 // Page size extension</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// </span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╓ё╕P╓Ы╛q©О╬э</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define SEG_KCODE 1 // kernel code</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define SEG_KDATA 2 // kernel <span class=SpellE>data+stack</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define SEG_UCODE 3 // user code</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define SEG_UDATA 4 // user <span class=SpellE>data+stack</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define SEG_TSS 5 // this process║╕s task state</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// <span class=SpellE>cpu</span>&#8722;&gt;<span
class=SpellE>gdt</span>[NSEGS] </span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╚O╕s╔H╓W╙╨╓Ы╛q</span><span lang=EN-US>.</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define NSEGS 6</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#<span class=SpellE>ifndef</span> __ASSEMBLER__</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Segment Descriptor</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>struct</span></span></span><span
lang=EN-US> <span class=SpellE>segdesc</span> {</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> lim_15_0 : 16; // Low bits of
segment limit</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> base_15_0 : 16; // Low bits
of segment base address</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> base_23_16 : 8; // Middle
bits of segment base address</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> type : 4; // Segment type
(see STS_ constants)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> s : 1; // 0 = system, 1 =
application</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>dpl</span>
: 2; // Descriptor Privilege Level</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> p : 1; // Present</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> lim_19_16 : 4; // High bits
of segment limit</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>avl</span>
: 1; // Unused (available for software use)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> rsv1 : 1; // Reserved</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>db</span>
: 1; // 0 = 16&#8722;bit segment, 1 = 32&#8722;bit segment</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> g : 1; // Granularity: limit
scaled by 4K when set</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> base_31_24 : 8; // High bits
of segment base address</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>};</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Normal segment</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define <span class=GramE>SEG(</span>type, base, <span
class=SpellE>lim</span>, <span class=SpellE>dpl</span>) (<span class=SpellE>struct</span>
<span class=SpellE>segdesc</span>) \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=GramE><span lang=EN-US>{ (</span></span><span lang=EN-US>(<span
class=SpellE>lim</span>) &gt;&gt; 12) &amp; 0xffff, (<span class=SpellE>uint</span>)(base)
&amp; 0xffff, \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>((<span class=SpellE><span class=GramE>uint</span></span>)(base)
&gt;&gt; 16) &amp; 0xff, type, 1, <span class=SpellE>dpl</span>, 1, \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>(<span class=SpellE><span class=GramE>uint</span></span>)(<span
class=SpellE><span class=GramE>lim</span></span>) &gt;&gt; 28, 0, 0, 1, 1, (<span
class=SpellE>uint</span>)(base) &gt;&gt; 24 }</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define <span class=GramE>SEG16(</span>type, base, <span
class=SpellE>lim</span>, <span class=SpellE>dpl</span>) (<span class=SpellE>struct</span>
<span class=SpellE>segdesc</span>) \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=GramE><span lang=EN-US>{ (</span></span><span
class=SpellE><span lang=EN-US>lim</span></span><span lang=EN-US>) &amp; 0xffff,
(<span class=SpellE>uint</span>)(base) &amp; 0xffff, \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>((<span class=SpellE><span class=GramE>uint</span></span>)(base)
&gt;&gt; 16) &amp; 0xff, type, 1, <span class=SpellE>dpl</span>, 1, \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>(<span class=SpellE><span class=GramE>uint</span></span>)(<span
class=SpellE><span class=GramE>lim</span></span>) &gt;&gt; 16, 0, 0, 1, 0, (<span
class=SpellE>uint</span>)(base) &gt;&gt; 24 }</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#<span class=SpellE>endif</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define DPL_USER 0x3 // User DPL</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Application segment type bits</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STA_X 0x8 // </span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔i╟У╕Ф╓Ы╛q</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STA_E 0x4 // Expand down (non&#8722;executable
segments)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STA_C 0x4 // Conforming code segment (executable
only)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STA_W 0x2 // </span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔i╪g</span><span lang=EN-US>(non&#8722;executable
segments)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STA_R 0x2 // </span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔iе╙</span><span lang=EN-US>(executable
segments)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STA_A 0x1 // Accessed</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// System segment type bits</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_T16A 0x1 // Available 16&#8722;bit TSS</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_LDT 0x2 // Local Descriptor Table</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_T16B 0x3 // Busy 16&#8722;bit TSS</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_CG16 0x4 // 16&#8722;bit Call Gate</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_TG 0x5 // Task Gate / <span class=SpellE>Coum</span>
<span class=SpellE>Transmitions</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_IG16 0x6 // 16&#8722;bit Interrupt Gate</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_TG16 0x7 // 16&#8722;bit Trap Gate</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_T32A 0x9 // Available 32&#8722;bit TSS</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_T32B 0xB // Busy 32&#8722;bit TSS</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_CG32 0xC // 32&#8722;bit Call Gate</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_IG32 0xE // 32&#8722;bit Interrupt Gate</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define STS_TG32 0xF // 32&#8722;bit Trap Gate</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// </span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╣Йюю╕a╖}</span><span lang=EN-US> <span
class=GramE>║╕</span>la<span class=GramE>║╕</span> </span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╕Ё╓T╜сЁ║╓ю</span><span lang=EN-US>:</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>//</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>//
+&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;10&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;+&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;10&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;+&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;12&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;+</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// | Page Directory | Page Table | Offset within Page
|</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// | Index | Index | |</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// +&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;+&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;+&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;&#8722;+</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// \&#8722;&#8722;&#8722; <span class=GramE>PDX(</span><span
class=SpellE>va</span>) &#8722;&#8722;/ \&#8722;&#8722;&#8722; PTX(<span class=SpellE>va</span>) &#8722;&#8722;/</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// page directory index</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define <span class=GramE>PDX(</span><span
class=SpellE>va</span>) (((<span class=SpellE>uint</span>)(<span class=SpellE>va</span>)
&gt;&gt; PDXSHIFT) &amp; 0x3FF)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// page table index</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define <span class=GramE>PTX(</span><span
class=SpellE>va</span>) (((<span class=SpellE>uint</span>)(<span class=SpellE>va</span>)
&gt;&gt; PTXSHIFT) &amp; 0x3FF)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>//</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╠q</span><span lang=EN-US>indexes and offset</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╚ь╨c╣Йюю╕a╖}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define <span class=GramE>PGADDR(</span>d, t, o) ((<span
class=SpellE>uint</span>)((d) &lt;&lt; PDXSHIFT | (t) &lt;&lt; PTXSHIFT | (o)))</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Page directory and page table constants.</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define NPDENTRIES 1024 // # directory entries per
page directory</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define NPTENTRIES 1024 // # PTEs per page table</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PGSIZE 4096 // bytes mapped by a page</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PGSHIFT 12 // <span class=GramE>log2(</span>PGSIZE)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTXSHIFT 12 // offset of PTX in a linear
address</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PDXSHIFT 22 // offset of PDX in a linear
address</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define <span class=GramE>PGROUNDUP(</span><span
class=SpellE>sz</span>) (((<span class=SpellE>sz</span>)+PGSIZE&#8722;1) &amp;
~(PGSIZE&#8722;1))</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define <span class=GramE>PGROUNDDOWN(</span>a)
(((a)) &amp; ~(PGSIZE&#8722;1))</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Page table/directory entry flags.</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTE_P 0x001 // Present</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTE_W 0x002 // Writeable</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTE_U 0x004 // User</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTE_PWT 0x008 // Write&#8722;Through</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTE_PCD 0x010 // Cache&#8722;Disable</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTE_A 0x020 // Accessed</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTE_D 0x040 // Dirty</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTE_PS 0x080 // Page Size</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTE_MBZ 0x180 // Bits must be zero</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Address in page table or page directory entry</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTE_<span class=GramE>ADDR(</span><span
class=SpellE>pte</span>) ((<span class=SpellE>uint</span>)(<span class=SpellE>pte</span>)
&amp; ~0xFFF)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PTE_<span class=GramE>FLAGS(</span><span
class=SpellE>pte</span>) ((<span class=SpellE>uint</span>)(<span class=SpellE>pte</span>)
&amp; 0xFFF)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#<span class=SpellE>ifndef</span> __ASSEMBLER__</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>typedef</span></span></span><span
lang=EN-US> <span class=SpellE>uint</span> <span class=SpellE>pte_t</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Task state segment format</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>struct</span></span></span><span
lang=EN-US> <span class=SpellE>taskstate</span> {</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> link; // Old <span
class=SpellE>ts</span> selector</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> esp0; // Stack pointers and
segment selectors</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> ss0; // after an increase
in privilege level</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> padding1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> *esp1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> ss1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> padding2;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> *esp2;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> ss2;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> padding3;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>void</span> *cr3; // Page directory base</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> *<span class=SpellE>eip</span>;
// Saved state from last task switch</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>eflags</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>eax</span>;
// More saved state (registers)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>ecx</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>edx</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>ebx</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> *<span class=SpellE>esp</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> *<span class=SpellE>ebp</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>esi</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>edi</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>es</span>;
// Even more saved state (segment selectors)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> padding4;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>cs</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> padding5;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>ss</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> padding6;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> ds;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> padding7;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> fs;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> padding8;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>gs</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> padding9;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>ldt</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> padding10;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> t; // Trap on task switch</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>iomb</span>;
// I/O map base address</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>};</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>║K</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Gate descriptors for interrupts and traps</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>struct</span></span></span><span
lang=EN-US> <span class=SpellE>gatedesc</span> {</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> off_15_0 : 16; // low 16 bits
of offset in segment</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>cs</span>
: 16; // code segment selector</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>args</span>
: 5; // # <span class=SpellE>args</span>, 0 for interrupt/trap gates</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> rsv1 : 3; // reserved(should
be zero I guess)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> type : 4; //
type(STS_{TG,IG32,TG32})</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> s : 1; // must be 0 (system)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>dpl</span>
: 2; // descriptor(meaning new) privilege level</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> p : 1; // Present</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> off_31_16 : 16; // high bits
of offset in segment</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>};</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Set up a normal interrupt/trap gate descriptor.</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// &#8722; <span class=SpellE>istrap</span>: 1 for a trap
(= exception) gate, 0 for an interrupt gate.</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// interrupt gate clears FL_IF, trap gate leaves
FL_IF alone</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// &#8722; <span class=SpellE>sel</span>: Code segment
selector for interrupt/trap handler</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// &#8722; off: Offset in code segment for interrupt/trap
handler</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// &#8722; <span class=SpellE>dpl</span>: Descriptor
Privilege Level &#8722;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// the privilege level required for software to
invoke</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// this interrupt/trap gate explicitly using an <span
class=SpellE>int</span> instruction.</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define <span class=GramE>SETGATE(</span>gate, <span
class=SpellE>istrap</span>, <span class=SpellE>sel</span>, off, d) \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{ \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>(<span class=GramE>gate</span>).off_15_0 = (<span
class=SpellE>uint</span>)(off) &amp; 0xffff; \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>(<span class=GramE>gate</span>).<span class=SpellE>cs</span>
= (<span class=SpellE>sel</span>); \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>(<span class=GramE>gate</span>).<span class=SpellE>args</span>
= 0; \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>(<span class=GramE>gate</span>).rsv1 = 0; \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>(<span class=GramE>gate</span>).type = (<span
class=SpellE>istrap</span>) ? STS_<span class=GramE>TG32 :</span> STS_IG32; \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>(<span class=GramE>gate</span>).s = 0; \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>(<span class=GramE>gate</span>).<span class=SpellE>dpl</span>
= (d); \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>(<span class=GramE>gate</span>).p = 1; \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>(<span class=GramE>gate</span>).off_31_16 = (<span
class=SpellE>uint</span>)(off) &gt;&gt; 16; \</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#<span class=SpellE>endif</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╧ЙеИ╙╨╟O╬пеИ╚Э╕Vюx╕s╕b</span><span
lang=EN-US>DRAM</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C╓@╜с</span><span lang=EN-US>byte</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╙╨╧ЙеИ╟O╬пеИ╕Ё╓@╜с╕a╖}╨ы╛╟╧ЙеИ╕a╖}║C╚Э╔O╔u╕Ё╗о╔н╣Йюю╕a╖}╛O</span><span
lang=EN-US>paging</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╣wеИб╫д╤╗Л╧ЙеИ╕a╖}║A╟e╗Л</span><span lang=EN-US>DRAM</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╣wеИ╔hе╙╘M╪gюx╕s║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span lang=EN-US>Process
address space<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>ЁпЁyбг╔я</span><span lang=EN-US>entry</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓w╦g╗╛╟В╟t╧О╔h╓╧Ё\</span><span
lang=EN-US>kernel</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨</span><span lang=EN-US>C</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╣{╕║╫X╔h╤}╘l╟У╕Ф║C╣M╕с</span><span lang=EN-US>main</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔ъ╗Х╖Оеэ╔h╓@╜с╥s╙╨</span><span
lang=EN-US>page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>бг╔я╘I╔s</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>kvmalloc</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>1840):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>//</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>ЁпЁy╘M╓а╢╚╓@╜с</span><span lang=EN-US>Page table</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔н╟t╧О╕b</span><span
lang=EN-US>KERNBASE</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓W╩щ╜n╣╧</span><span lang=EN-US>kernel</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔h╟У╕Ф</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>kvmalloc</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>void)<span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>kpgdir</span></span> = <span class=SpellE>setupkvm</span>();</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>switchkvm</span></span><span class=GramE>(</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕]╛╟</span><span
lang=EN-US>kernel</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓w╦g╕Ё╓@╜с╖С╕hдд╜z╜p╣e╔h╢y╜z</span><span lang=EN-US>process</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕a╖}╙е╤║║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╗C╓@╜с</span><span
lang=EN-US>process</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╕Ё╓@╜с╓ю╢╡</span><span lang=EN-US>page table</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║A╘M</span><span
lang=EN-US>xv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╖i╤D</span><span lang=EN-US>page table</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╣wеИ╔h╓а╢╚</span><span lang=EN-US>page
tables</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╥М</span><span lang=EN-US>xv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╓а╢╚╕b</span><span lang=EN-US>process</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╤║║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>Memlayout.h</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>0200):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Memory layout</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define EXTMEM 0x100000 // Start of extended memory</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define PHYSTOP 0xE000000 // Top physical memory</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define DEVSPACE 0xFE000000 // <span class=GramE>Other</span>
devices are at high addresses</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>// Key addresses for address space layout (see <span
class=SpellE>kmap</span> in <span class=SpellE>vm.c</span> for layout)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define KERNBASE 0x80000000 // First kernel virtual
address</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define KERNLINK (KERNBASE+EXTMEM) // Address where kernel
is linked</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define <span class=GramE>V2P(</span>a) (((<span
class=SpellE>uint</span>) (a)) &#8722; KERNBASE)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define <span class=GramE>P2V(</span>a) (((void *)
(a)) + KERNBASE)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define V2P_WO(x) ((x) &#8722; KERNBASE) // same as V2P,
but without casts</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>#define P2V_WO(x) ((x) + KERNBASE) // same as P2V,
but without casts</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╥М╓@╜с</span><span
lang=EN-US>process</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╟щ</span><span lang=EN-US>xv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╖С╕h╟O╬пеИ║A</span><span lang=EN-US>xv6</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╡д<span
class=GramE>╓@╜с╖Д╙е╙╨</span>╧ЙеИ</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔h╢ё╗я║A╘M╪W╔[</span><span
lang=EN-US>PTEs</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╗Л</span><span lang=EN-US>process</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╙╨</span><span lang=EN-US>page table</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║A╚Э╗Л╥s╙╨╟O╬пеИ</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C</span><span lang=EN-US>Xv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>Ё]╘w</span><span lang=EN-US>PTE_U,PTE_W</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╘M</span><span
lang=EN-US>PTE_P</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╨X╪п╕b</span><span lang=EN-US>PTEs</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>║C╖С╕h</span><span lang=EN-US>process</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓ё╞Ю╗о╔н╔ЧЁ║╙╨╗о╔н╙л╕a╖}╙е╤║║C</span><span
lang=EN-US>Xv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╞d</span><span lang=EN-US>PTE_P</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╡M╟ё╕b╗S╗о╔н╙╨</span><span lang=EN-US>PTEs</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║C╓ё╕P╙╨</span><span
lang=EN-US>process</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨</span><span lang=EN-US>page table</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>б╫д╤╗о╔н╙л╕a╖}╗Л╓ё╕P╙╨╧ЙеИ╟O╬пеИ╙╨</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║A╘р╔H╗C╓@╜с</span><span lang=EN-US>process</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>Ёё╕Ё╕U╕ш╗о╔н╙л╟O╬пеИ║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Xv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╔]╖t╘р╕Ё╟t╧О╩щ╜n╣╧</span><span lang=EN-US>kernel</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔h╟У╕Ф╕b╗C<span
class=GramE>╜с</span></span><span lang=EN-US>process</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╙╨</span><span
lang=EN-US>page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║F╗╨╗г╟t╧О╘р╕Ё╔X╡{╕b</span><span lang=EN-US>KERNBASE</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║C╔╕╟t╧О╣Йюю╕a╖}</span><span
lang=EN-US>KERN-BASE:KERNBASE+PHYSTOP to 0:PHYSTOP</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║C╓@╜с╡z╔я╛OЁo╜с╟t╧О╛O</span><span
lang=EN-US>kernel</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔i╔H╗о╔н╔╕╕ш╓v╙╨╚Э╔O╘M╦Й╝ф║C╔t╓@╜с╡z╔я╛O</span><span lang=EN-US>kernel</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕Ё╝и╜т╩щ╜n╔h╪g╓@╜с╧ЙеИ╟O╬пеИ╙╨</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║A╗р╕p╥МЁпЁy</span><span lang=EN-US>page table pages</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║F╕Ё╗C<span
class=GramE>╜с</span>╧ЙеИ</span><span lang=EN-US>Page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔X╡{╕b╔i╧w╢З╙╨╣Йюю╕a╖}║C╓@╜с╕w╠ф╙╨╞йЁ╢╛O</span><span
lang=EN-US>sv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓ё╞Ю╗о╔н╕h╬l</span><span lang=EN-US>2GB</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╙╨╧ЙеИ╟O╬пеИ║C╖С╕hЁ]Ёф╗о╔н╟O╬пеИ╟t╧О</span><span
lang=EN-US>I/O</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔X╡{╕b╧ЙеИ╕a╖}╤}╘l╕b</span><span lang=EN-US>0xFE00000</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║A╘р╔H</span><span
lang=EN-US>xv6 page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╔]╖t╓@╜с╙╫╠╣╟t╧О╣╧╔L╜л║C</span><span lang=EN-US>Xv6</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓ё╞ЮЁ]╘w</span><span
lang=EN-US>PTE_U</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╨X╪п╕b</span><span lang=EN-US>KERN_BASE</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╓W╙╨</span><span lang=EN-US>PTEs</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║A╘р╔H╔u╕Ё</span><span
lang=EN-US>kernel</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔i╔H╗о╔н╔╕╜л║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span lang=EN-US>Code:
creating an address space<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Main</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╘I╔s</span><span class=SpellE><span lang=EN-US>kvmalloc</span></span><span
lang=EN-US>(1840)</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔hЁпЁy╘M╓а╢╚╓@╜с</span><span lang=EN-US>Page table</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔н╟t╧О╕b</span><span
lang=EN-US>KERNBASE</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓W╩щ╜n╣╧</span><span lang=EN-US>kernel</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔h╟У╕Ф║C╓j╕h╪ф╓u╖@╣o╔м╕b</span><span
class=SpellE><span lang=EN-US>setupkvm</span></span><span lang=EN-US>(1818):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>setupkvm</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>void)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>pde_t</span> *<span class=SpellE>pgdir</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>struct</span></span> <span class=SpellE>kmap</span>
*k;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╟t╦m╓@╜с</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨╟O╬пеИ╗с╚O╕s</span><span lang=EN-US>page directory</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>(<span class=SpellE>pgdir</span> = (<span class=SpellE>pde_t</span>*)<span
class=SpellE>kalloc</span>()) == 0)<span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-spacerun:yes'>&nbsp;</span><span class=GramE>return</span> 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>memset</span></span><span class=GramE>(</span><span
class=SpellE>pgdir</span>, 0, PGSIZE);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if</span> (P2V(PHYSTOP) &gt; (void*)DEVSPACE)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>panic(</span>&quot;PHYSTOP too high&quot;);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>for(</span>k = <span class=SpellE>kmap</span>; k &lt; &amp;<span
class=SpellE>kmap</span>[NELEM(<span class=SpellE>kmap</span>)]; k++)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╘I╔s</span><span
class=SpellE><span lang=EN-US>mappages</span></span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔h╕w╦к</span><span lang=EN-US>kernel</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╩щ╜n╙╨б╫д╤</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>mappages</span>(<span class=SpellE>pgdir</span>,
k&#8722;&gt;<span class=SpellE>virt</span>, k&#8722;&gt;<span class=SpellE>phys_end</span>
&#8722; k&#8722;&gt;<span class=SpellE>phys_start</span>,</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(<span
class=SpellE><span class=GramE>uint</span></span><span class=GramE>)</span>k&#8722;&gt;<span
class=SpellE>phys_start</span>, k&#8722;&gt;perm) &lt; 0) {</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>freevm</span></span><span class=GramE>(</span><span
class=SpellE>pgdir</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:4'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> <span class=SpellE>pgdir</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕b</span><span
class=SpellE><span lang=EN-US>kmap</span></span><span lang=EN-US>(1809):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>kmap</span></span></span><span
class=GramE><span lang=EN-US>[</span></span><span lang=EN-US>] = {</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=GramE><span lang=EN-US>{ (</span></span><span lang=EN-US>void*)KERNBASE,
0, EXTMEM, PTE_W}, // I/O space</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=GramE><span lang=EN-US>{ (</span></span><span lang=EN-US>void*)KERNLINK,
V2P(KERNLINK), V2P(data), 0}, // kern <span class=SpellE>text+rodata</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=GramE><span lang=EN-US>{ (</span></span><span lang=EN-US>void*)data,
V2P(data), PHYSTOP, PTE_W}, // kern <span class=SpellE>data+memory</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=GramE><span lang=EN-US>{ (</span></span><span lang=EN-US>void*)DEVSPACE,
DEVSPACE, 0, PTE_W}, // more devices</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>};</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>Ёo╜с╔]╖t</span><span
lang=EN-US>kernel</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨╚Э╔O╘M╦Й╝ф║A╧ЙеИ╟O╬пеИ╗Л</span><span lang=EN-US>PHYSTOP</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╘M╧Й╩з╓W╛O</span><span
lang=EN-US>I/O</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>Ё]Ёф╙╨╟O╬пеИ╫dЁР║C</span><span class=SpellE><span lang=EN-US>Setupkvm</span></span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓ё╞Ю╕w╦к╘р╕Ё╟t╧О╣╧╗о╔н╙л╟O╬пеИ║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>Mappages</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>1760):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>mappages</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span class=SpellE><span
lang=EN-US>pde_t</span></span><span lang=EN-US> *<span class=SpellE>pgdir</span>,
void *<span class=SpellE>va</span>, <span class=SpellE>uint</span> size, <span
class=SpellE>uint</span> pa, <span class=SpellE>int</span> perm)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>char</span> *a, *last;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>pte_t</span> *<span class=SpellE>pte</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>a
= (char*<span class=GramE>)PGROUNDDOWN</span>((<span class=SpellE>uint</span>)<span
class=SpellE>va</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>last</span> = (char*)PGROUNDDOWN(((<span class=SpellE>uint</span>)<span
class=SpellE>va</span>) + size &#8722; 1);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>for(</span>;;){</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>(<span class=SpellE>pte</span> = <span class=SpellE>walkpgdir</span>(<span
class=SpellE>pgdir</span>, a, 1)) == 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> &#8722;1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>*<span class=SpellE>pte</span> &amp; PTE_P)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>panic(</span>&quot;remap&quot;);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*<span
class=SpellE>pte</span> = pa | perm | PTE_P;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>a == last)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>break</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>a
+= PGSIZE;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>pa</span> += PGSIZE;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal style='text-align:justify;text-justify:inter-ideograph;
text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕w╦к╟t╧О╕b</span><span
lang=EN-US>page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╣╧╓@╜с╣Йюю╕a╖}╙╨╫dЁР╔h╧ОюЁ╧ЙеИ╕a╖}╙╨╫dЁР║C╗C╓@╜с╣Йюю╕a╖}ЁQ╟t╧О</span><span class=SpellE><span
lang=EN-US>mappages</span></span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╘I╔s</span><span class=SpellE><span lang=EN-US>walkpgdir</span></span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔h╢M╖Д╦с╕a╖}╙╨</span><span
lang=EN-US>PTE</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨╕a╖}║C╔╕╙Л╘l╓ф</span><span lang=EN-US>PTE</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔h╚O╕s╛шюЁ╧ЙеИ</span><span lang=EN-US>page
number</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║A╘р╩щ╙╨еv╜╜║A╘M</span><span lang=EN-US>PTE_P</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔h╪п╟O</span><span
lang=EN-US>PTE</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╛O</span><span lang=EN-US>valid(1772)</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>Walkpgdir</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>1735):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>walkpgdir</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span class=SpellE><span
lang=EN-US>pde_t</span></span><span lang=EN-US> *<span class=SpellE>pgdir</span>,
<span class=SpellE>const</span> void *<span class=SpellE>va</span>, <span
class=SpellE>int</span> <span class=SpellE>alloc</span>)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>pde_t</span> *<span class=SpellE>pde</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>pte_t</span> *<span class=SpellE>pgtab</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╗о╔н╣Йюю╕a╖}╙╨╓W╜╠</span><span
lang=EN-US>10bit</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔h╢M╖Д</span><span lang=EN-US>page directory entry</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>pde</span></span> = &amp;<span class=SpellE>pgdir</span>[PDX(<span
class=SpellE>va</span>)];</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>*<span class=SpellE>pde</span> &amp; PTE_P){</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>pgtab</span></span> = (<span class=SpellE>pte_t</span>*)P2V(PTE_ADDR(*<span
class=SpellE>pde</span>));</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} else {</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕p╙G</span><span
lang=EN-US>page directory</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╓ё╕s╕b</span></p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:24.0pt;line-height:
16.0pt;mso-line-height-rule:exactly'><span lang=EN-US>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╚h╩щ╜n╙╨</span><span
lang=EN-US>page table page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>аы╗SЁQ╓ю╟t</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>!<span class=SpellE>alloc</span> || (<span class=SpellE>pgtab</span>
= (<span class=SpellE>pte_t</span>*)<span class=SpellE>kalloc</span>()) == 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╫T╚O╘р╕Ё</span><span
lang=EN-US>PTE_P bits</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>Ёё╛O</span><span lang=EN-US>0</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>memset</span></span><span class=GramE>(</span><span
class=SpellE>pgtab</span>, 0, PGSIZE);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>Ёo╦л╙╨еv╜╜╧L╓ю╨B╢n</span><span
lang=EN-US>, </span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╕Щ╔╕╜л╔i╔H</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╤i╓@╗B╜╜╗Нбг╔яеv╜╜╤i╓J</span><span
lang=EN-US>page table</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//,
</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔╡╜n╝и</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*<span
class=SpellE>pde</span> = <span class=GramE>V2P(</span><span class=SpellE>pgtab</span>)
| PTE_P | PTE_W | PTE_U;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╗о╔н╣Йюю╕a╖}╙╨╓U</span><span
lang=EN-US>10</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╜с</span><span lang=EN-US>bit</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╔h╢M╖Д╕b</span><span lang=EN-US>page table page
PTE</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╙╨╕a╖}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> &amp;<span class=SpellE>pgtab</span>[PTX(<span
class=SpellE>va</span>)];</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╪р╔И</span><span
lang=EN-US>x86 paging</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╣wеИ╙╨╟й╖@╧Ё╔╕╛d╦ъ</span><span lang=EN-US>PTE</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╓@╜с╣Йюю╕a╖}║C╕p╙G</span><span class=SpellE><span
lang=EN-US>alloc</span></span><span lang=EN-US> </span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>Ё]╘w║A</span><span class=SpellE><span
lang=EN-US>walkpgdir</span></span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╓ю╟t╔╕╘M╘Я╔╕╙╨╧ЙеИ╕a╖}╕b</span><span lang=EN-US>page
directory</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span lang=EN-US>Physical
memory allocation<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Kernel</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╔╡╤╥╓ю╟t╘Mдю╘Я╧ЙеИ╟O╬пеИ╕b╟У╕Ф╝и╣╧</span><span lang=EN-US>page
table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║B</span><span
lang=EN-US>process</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╗о╔н╙л╟O╬пеИ║B</span><span lang=EN-US>kernel</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╟Ое|╘M</span><span
lang=EN-US>Pipe buffers</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Xv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╗о╔н╕b</span><span lang=EN-US>kernel</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╘M</span><span
lang=EN-US>PHYSTOP</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓╖╤║╙╨╧ЙеИ╟O╬пеИ╕b╟У╕Ф╝и╓ю╟t║C╔╕╓ю╟t╘Mдю╘Я╔ЧЁ║</span><span lang=EN-US>4096 bytes page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕b╕P╓@╝и╤║║C╔╕╚O╚ЫЁz╧L╫u╣{Ёs╠╣╕C╙М╟lбэ╗╨╗г</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C╓ю╟t╔]╖t╠q╓@╜сЁs╠╣╕C╙М╡╬╟ё╓@╜с</span><span lang=EN-US>Page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║Fдю╘Я╔]╖t╪W╔[╙е╙╨</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╗Л╕C╙М║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span lang=EN-US>Code:
Physical memory allocator<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓ю╟t╙╨╦Й╝ф╣╡╨c╛O╧ЙеИ╟O╬пеИ</span><span
lang=EN-US>Pages</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨дю╘Я╕C╙М║A╛O╔i╔HЁQ╓ю╟t║C╗C╓@╜с╙е</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╙╨╕C╙М╓╦╞ю╛O</span><span
class=SpellE><span lang=EN-US>struct</span></span><span lang=EN-US> run(3115):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>struct</span></span></span><span
lang=EN-US> run {</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>struct</span></span> run *next;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>};</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span lang=EN-US>struct</span></span><span
lang=EN-US> {<span style='mso-tab-count:6'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//spin
lock</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>struct</span></span> spinlock lock;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>int</span></span> <span class=SpellE>use_lock</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>struct</span></span> run *<span class=SpellE>freelist</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>} <span class=SpellE>kmem</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔╕юx╕s╗C<span
class=GramE>╜с</span>дю╘Я</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╙╨</span><span
lang=EN-US>run</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╣╡╨c╕bдю╘Я</span><span lang=EN-US>page</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔╩╗╜║A╕ш╠q╗S╕Ё╗Д╔Lюx╕s╕b╗╨║C<span class=GramE>╙е╞P╙М╔э</span>ЁQ╓@╜с</span><span
lang=EN-US>spin lock</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╚Oе@║CЁo╕C╙М╘MЁo╜с</span><span lang=EN-US>lock</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>ЁQ╔]╕b╓@╜с</span><span
class=SpellE><span lang=EN-US>struct</span></span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔h╖к╡M╥║Ёo╜с</span><span lang=EN-US>lock</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╚Oе@╕b</span><span
class=SpellE><span lang=EN-US>struct</span></span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╙╨╩Б╟Л║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Main</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╘I╔s</span><span lang=EN-US>kinit1</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╘M</span><span
lang=EN-US>kinit2</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔h╙Л╘l╓ф╓ю╟t</span><span lang=EN-US>(3131):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=GramE><span lang=EN-US>kinit1(</span></span><span
lang=EN-US>void *<span class=SpellE>vstart</span>, void *vend)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>initlock</span></span><span class=GramE>(</span>&amp;<span
class=SpellE>kmem.lock</span>, &quot;<span class=SpellE>kmem</span>&quot;);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>kmem.use_lock</span> = 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>freerange</span></span><span class=GramE>(</span><span
class=SpellE>vstart</span>, vend);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>void</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=GramE><span lang=EN-US>kinit2(</span></span><span
lang=EN-US>void *<span class=SpellE>vstart</span>, void *vend)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>freerange</span></span><span class=GramE>(</span><span
class=SpellE>vstart</span>, vend);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>kmem.use_lock</span> = 1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╧О╘С╚э╕h</span><span
lang=EN-US>main</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓@╜с╓ё╞Ю╗о╔н</span><span lang=EN-US>locks</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╘н╟O╬пеИ╕b</span><span lang=EN-US>4MB</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔H╓W║C</span><span
lang=EN-US>Kinit1</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>Ё]╘w╣╧</span><span lang=EN-US>lock-less</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╓ю╟t╕b╚e</span><span lang=EN-US>4GB</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║A</span><span
lang=EN-US>kinit2</span><span class=GramE><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╗обЙ╕М</span></span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╘M╕w╠ф╖С╕h╟O╬пеИ╔h╟t╓ю╟t║C</span><span lang=EN-US>Main</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>юЁ╦с╔h╫T╘w╕h╓ж╧ЙеИ╟O╬пеИ╛O╔i╔н╙╨║A╕ЩЁo╕b</span><span
lang=EN-US>x86</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓W╚э╖xцЬ║C</span><span lang=EN-US>kinity1</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╘M</span><span lang=EN-US>kinit2</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╘I╔s</span><span
class=SpellE><span lang=EN-US>freerange</span></span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔h╪W╔[╟O╬пеИ╗Л╙е╕C╙Мбг╔я╗C<span class=GramE>╜с</span></span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╘I╔s</span><span class=SpellE><span lang=EN-US>kfree</span></span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║C╓@╜с</span><span
lang=EN-US>PTE</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔i╔H╔u╕Ё╚Э╕V╓@╜с╧ЙеИ╟O╬пеИ║A╘р╔H</span><span class=SpellE><span lang=EN-US>freerange</span></span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╗о╔н</span><span
lang=EN-US>PGROUNDUP</span><span class=GramE><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╔h╚o╙М╔╕</span></span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>дю╘Я╔u╕Ё╧ЙеИ╕a╖}║C╓ю╟t╤}╘l╗S╕Ё╟O╬пеИ║FЁo╗г╘I╔s╔h</span><span
class=SpellE><span lang=EN-US>kfree</span></span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╣╧╔╕╓@╗г╔h╨ч╡z║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓ю╟t╗Л╧ЙеИ</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>бг╔я╔╕╜л╙╨╣Йюю╕a╖}║A╓ё╛Oбг╔я╔╕╜л╙╨╧ЙеИ╕a╖}║AЁo╛O╛╟╓╟╩Р</span><span lang=EN-US>kinit</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╗о╔н</span><span
lang=EN-US>P2V(PHYSTOP)</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╔hб╫д╤</span><span lang=EN-US>PHYSTOP(</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓@╜с╧ЙеИ╕a╖}</span><span
lang=EN-US>)</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╗Л╓@╜с╣Йюю╕a╖}║C╓ю╟t╕Ё╝и╜т╥|╔н╬Ц╪ф╔N╙М╕a╖}╛╟╓F╓Х╚K╧B╨Б║A╕Ё╝и╜т╗о╔н</span><span lang=EN-US>pointer</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔hе╙╘M╪g╟O╬пеИ║F╕a╖}╙╨бЫ╜╚╗о╔н╙╨╔D╜n╜Л╕]╛O╓ю╟t╣{╕║╫XЁё╛O</span><span
lang=EN-US>C type</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C╔t╓@╜с╜Л╕]╛Oдю╘Я╘M╓ю╟t╔╩╫Х╖Оеэ╟O╬пеИ╙╨╚╛╨A║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>Kfree</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>3164):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>kfree</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>char *v)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>struct</span></span> run *r;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>(<span class=SpellE>uint</span>)v % PGSIZE || v &lt; end
|| V2P(v) &gt;= PHYSTOP)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>panic(</span>&quot;<span class=SpellE>kfree</span>&quot;);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// Fill with junk
to catch dangling refs.</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>memset</span></span><span class=GramE>(</span>v,
1, PGSIZE);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>kmem.use_lock</span>)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>acquire(</span>&amp;<span class=SpellE>kmem.lock</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>r = (<span
class=SpellE>struct</span> run*<span class=GramE>)v</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>r</span>&#8722;&gt;next = <span class=SpellE>kmem.freelist</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>kmem.freelist</span> = r;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>kmem.use_lock</span>)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>release(</span>&amp;<span class=SpellE>kmem.lock</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╤}╘l╢N╔яЁ]╘w╕b╟O╬пеИ╙╨╗C<span
class=GramE>╜с</span></span><span lang=EN-US>byte</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╤}╘l<span class=GramE>дю╘Я╗Л╜х</span></span><span
lang=EN-US>1</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║CЁo╥|Ёy╕╗╣{╕║╫X╗о╔н╟O╬пеИ╕bдю╘Я╔╕╓╖╚А╔hе╙╘U╖ё╗З╔Nбб╙╨╜х║F╖ф╠ФЁo╥|╖С╖ж║C</span><span class=SpellE><span
lang=EN-US>Kfree</span></span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╙╨</span><span lang=EN-US>v</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╛O</span><span
lang=EN-US>pointer</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╗Л</span><span class=SpellE><span lang=EN-US>struct</span></span><span
lang=EN-US> run</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║A╛Ж©Щ╢N╙╨╤}╘lдю╘Я╕C╙М╕b</span><span lang=EN-US>r-&gt;next</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║AЁ]╘wдю╘Я╕C╙М╣╔╘С</span><span
lang=EN-US>r</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C</span><span class=SpellE><span lang=EN-US>kalloc</span></span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╡╬╟ё╘M╕^╤г╕bдю╘Я╕C╙М╙╨╡д╓@╜с╓╦╞ю║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span lang=EN-US>User
part of an address space<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╗C<span
class=GramE>╜с</span>╗о╔н╙л</span><span lang=EN-US>process</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╤}╘l╕b╕a╖}</span><span
lang=EN-US>0</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C╕a╖}╙е╤║╙╨╘ЁЁ║╔]╖t╗о╔н╙л╣{╕║╫X║B╦Й╝ф╘M╟Ое|║C</span><span lang=EN-US>Heap</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕b╟Ое|╓╖╓W╘р╔H</span><span
lang=EN-US>heap</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔i╔HбX╝i╥М╔╕╘I╔s</span><span class=SpellE><span lang=EN-US>sbrk</span></span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║C╥М</span><span
lang=EN-US>xv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>бX╝i╓@╜с</span><span lang=EN-US>process</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╙╨</span><span lang=EN-US>heap</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║A╔╕╔i╔H╗о╔н╔Т╕С</span><span
lang=EN-US>free</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨╧ЙеИ</span><span lang=EN-US>page</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╣╧╥s╙╨╣Йюю</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╣M╚АеЩ</span><span
lang=EN-US>page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╣wеИ╔h╟t╧О╣Йюю</span><span lang=EN-US>page</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╗Л╓ю╟t╙╨╧ЙеИ</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╟Ое|╛OЁФ╓@╙╨</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║A╙М╔э╘MЁQ</span><span lang=EN-US>exec</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>ЁпЁy╙╨╙Л╘l╓╨╝e╓@╪к║C</span><span lang=EN-US>Strings</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔]╖t╘R╔O╟я╪ф║A╢N╧Ё╓@╜с</span><span
lang=EN-US>pointer</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨╟}╕C╗Л╔╕╜л║A╛O╕b╟Ое|╙╨Ё╩╨щ║C╓@╜с╣{╕║╠q</span><span lang=EN-US>main</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╤}╘l╢N╕V</span><span
lang=EN-US>function</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╘I╔s</span><span lang=EN-US>main(<span class=SpellE>argc,argv</span>)</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╤}╘l║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span lang=EN-US>Code:
<span class=SpellE>sbrk</span><o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span lang=EN-US>Sbrk</span></span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╛O</span><span
lang=EN-US>system call</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╣╧╓@╜с</span><span lang=EN-US>process</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔h╕╛аY╘н╕╗╙Ь╔╕╙╨╟O╬пеИ║Cбг╔я</span><span
class=SpellE><span lang=EN-US>growproc</span></span><span lang=EN-US>(2558)</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╗с╧Й╛I║F</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>growproc</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span class=SpellE><span
lang=EN-US>int</span></span><span lang=EN-US> n)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>sz</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>struct</span></span> proc *<span class=SpellE>curproc</span>
= <span class=SpellE>myproc</span>();</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>sz</span> = <span class=SpellE>curproc</span>&#8722;&gt;<span
class=SpellE>sz</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕p╙G</span><span
lang=EN-US>n</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╛O╔©╙╨</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>n &gt; 0){</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
<span class=SpellE>growproc</span></span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╓ю╟t╓@╜с╔H╓W╙╨╧ЙеИ</span><span lang=EN-US>page</span></p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:24.0pt;line-height:
16.0pt;mso-line-height-rule:exactly'><span lang=EN-US>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╘M╧ОюЁ╔╕╜л╕b</span><span
lang=EN-US>process</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨╕a╖}╙е╤║Ё╩╨щ</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>(<span class=SpellE>sz</span> = <span class=SpellE>allocuvm</span>(<span
class=SpellE>curproc</span>&#8722;&gt;<span class=SpellE>pgdir</span>, <span
class=SpellE>sz</span>, <span class=SpellE>sz</span> + n)) == 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> &#8722;1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕p╙G</span><span
lang=EN-US>n</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╛O╜t╙╨</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} else <span
class=GramE>if(</span>n &lt; 0){</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
<span class=SpellE>gorwproc</span></span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╓ё╥|╧ОюЁ╓@╜с╔H╓W</span><span lang=EN-US>page</span></p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:24.0pt;line-height:
16.0pt;mso-line-height-rule:exactly'><span lang=EN-US>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╠q</span><span
lang=EN-US>process</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨╕a╖}╙е╤║╘Mдю╘Я╛шюЁ╙╨╧ЙеИ</span><span lang=EN-US>page</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>(<span class=SpellE>sz</span> = <span class=SpellE>deallocuvm</span>(<span
class=SpellE>curproc</span>&#8722;&gt;<span class=SpellE>pgdir</span>, <span
class=SpellE>sz</span>, <span class=SpellE>sz</span> + n)) == 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> &#8722;1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>curproc</span></span>&#8722;&gt;<span class=SpellE>sz</span>
= <span class=SpellE>sz</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>switchuvm</span></span><span class=GramE>(</span><span
class=SpellE>curproc</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Xv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╜в╔©</span><span lang=EN-US>process</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╙╨</span><span
lang=EN-US>page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C</span><span lang=EN-US>Process</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╙╨</span><span lang=EN-US>page table</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>ЁQюx╕s╕b╟O╬пеИ║A╘р╔H</span><span
lang=EN-US>kernel</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔i╔H╔н╢╤Ёq╓ю╟t╚Э╔O╓и╞е</span><span lang=EN-US>table</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║A</span><span
class=SpellE><span lang=EN-US>allocuvm</span></span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╘M</span><span class=SpellE><span
lang=EN-US>deallocuvm</span></span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╔h╟╣║C</span><span lang=EN-US>X86</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╣wеИ</span><span
lang=EN-US>caches page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╤i╓J╕b</span><span lang=EN-US>Translation
Look-aside Buffer(TLB)</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>║A╥М</span><span lang=EN-US>xv6</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╖Оеэ</span><span
lang=EN-US>page table</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║A╔╕╔╡╤╥╪o╓Н</span><span lang=EN-US>cache</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╤i╓J║C╕p╙G╔╕╗S╕Ё╪o╓Н</span><span lang=EN-US>cache</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╤i╓J║A╕b╛Y╗г╝и╜т</span><span
lang=EN-US>TLB</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╔i╞Ю╥|╗о╔н╗Лбб╙╨╟t╧О║A╚Э╕V╧ЙеИ</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╝и╓w╦gЁQ╓ю╟t╗Л╗Д╔L╙╨</span><span
lang=EN-US>process</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║A╣╡╙G╥|Ёy╕╗╓@╜с</span><span lang=EN-US>process</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔i╞Ю╔h╔н╗Л╗Д╔L</span><span
lang=EN-US>process</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╙╨╟O╬пеИ║C</span><span lang=EN-US>Xv6</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╪o╓Нбб╙╨</span><span lang=EN-US>cache</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╤i╓J║A╢N╔я╜╚╥sе╙╓J</span><span
lang=EN-US>cr3</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╪х╕s╬╧╚O╕s╓F╔ь╚e</span><span lang=EN-US>page table</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╙╨╕a╖}║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><b style='mso-bidi-font-weight:normal'><span lang=EN-US>Code:
exec<o:p></o:p></span></b></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Exec</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╛O</span><span lang=EN-US>system call</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>ЁпЁy╓@╜с╕a╖}╙е╤║╙╨╗о╔н╙лЁ║╓ю║C╔╕╙Л╘l╓ф╕a╖}╙е╤║╙╨╗о╔н╙лЁ║╓ю╠q╓@╜сюи╝вюx╕s╗Люи╝в╗t╡н║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=GramE><span lang=EN-US>Exec(</span></span><span
lang=EN-US>6610):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=GramE><span lang=EN-US>exec(</span></span><span
lang=EN-US>char *path, char **<span class=SpellE>argv</span>)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>char</span> *s, *last;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>int</span></span> <span class=SpellE>i</span>,
off;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>argc</span>,
<span class=SpellE>sz</span>, <span class=SpellE>sp</span>, <span class=SpellE>ustack</span>[3+MAXARG+1];</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>struct</span></span> <span class=SpellE>elfhdr</span>
elf;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>struct</span></span> <span class=SpellE>inode</span>
*<span class=SpellE>ip</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>struct</span></span> <span class=SpellE>proghdr</span>
<span class=SpellE>ph</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>pde_t</span> *<span class=SpellE>pgdir</span>, *<span
class=SpellE>oldpgdir</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>struct</span></span> proc *<span class=SpellE>curproc</span>
= <span class=SpellE>myproc</span>();</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>begin_<span class=GramE>op</span></span><span class=GramE>(</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if((<span
class=SpellE>ip</span> = <span class=SpellE>namei</span>(path)) == 0){<span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp; </span><span style='mso-tab-count:
1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╤}╠р╘R╕W╙╨╓G╤i╕Л</span><span
lang=EN-US>path</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>end_<span class=GramE>op</span></span><span class=GramE>(</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>cprintf</span></span><span class=GramE>(</span>&quot;exec:
fail\n&quot;);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> &#8722;1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ilock</span></span><span class=GramE>(</span><span
class=SpellE>ip</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>pgdir</span></span> = 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>юк╛d</span><span
lang=EN-US>ELF</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╪пюYюи</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╜Y╕Ё©Ы╩~║A╦У╗Л</span><span
lang=EN-US>bad</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>readi</span>(<span class=SpellE>ip</span>,
(char*)&amp;elf, 0, <span class=SpellE>sizeof</span>(elf)) != <span
class=SpellE>sizeof</span>(elf))</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>elf.magic</span> != ELF_MAGIC)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓ю╟t╗S╕ЁЁQ╟t╧О╗Л╥s╙╨</span><span
lang=EN-US>page table</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>(<span class=SpellE>pgdir</span> = <span class=SpellE>setupkvm</span>())
== 0)<span style='mso-tab-count:1'>&nbsp; </span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// </span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╠q╟O╬пеИе╙╣{╕║</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>sz</span></span> = 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>for(</span><span class=SpellE>i</span>=0, off=<span class=SpellE>elf.phoff</span>;
<span class=SpellE>i</span>&lt;<span class=SpellE>elf.phnum</span>; <span
class=SpellE>i</span>++, off+=<span class=SpellE>sizeof</span>(<span
class=SpellE>ph</span>)){</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>readi</span>(<span class=SpellE>ip</span>,
(char*)&amp;<span class=SpellE>ph</span>, off, <span class=SpellE>sizeof</span>(<span
class=SpellE>ph</span>)) != <span class=SpellE>sizeof</span>(<span
class=SpellE>ph</span>))</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>ph.type</span> != ELF_PROG_LOAD)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>continue</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>ph.memsz</span> &lt; <span
class=SpellE>ph.filesz</span>)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>ph.vaddr</span> + <span class=SpellE>ph.memsz</span>
&lt; <span class=SpellE>ph.vaddr</span>)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓ю╟t╟O╬пеИ╣╧╗C<span
class=GramE>╜с</span></span><span lang=EN-US>ELF</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╟о╛q</span></p>

<p class=MsoNormal style='margin-left:72.0pt;text-indent:24.0pt;line-height:
16.0pt;mso-line-height-rule:exactly'><span lang=EN-US>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>юк╛d╣Йюю╕a╖}╜n╗D╕b</span><span
lang=EN-US>KERNBASE</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓╖╓U</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>(<span class=SpellE>sz</span> = <span class=SpellE>allocuvm</span>(<span
class=SpellE>pgdir</span>, <span class=SpellE>sz</span>, <span class=SpellE>ph.vaddr</span>
+ <span class=SpellE>ph.memsz</span>)) == 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>ph.vaddr</span> % PGSIZE != 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>loaduvm</span>(<span class=SpellE>pgdir</span>,
(char*)<span class=SpellE>ph.vaddr</span>, <span class=SpellE>ip</span>, <span
class=SpellE>ph.off</span>, <span class=SpellE>ph.filesz</span>) &lt; 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>iunlockput</span></span><span class=GramE>(</span><span
class=SpellE>ip</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>end_<span class=GramE>op</span></span><span class=GramE>(</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ip</span></span> = 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓ю╟t╗Б╜с</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╕b╓U╓@╜с</span><span lang=EN-US>page</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╙╨╫dЁР</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
Make the first inaccessible. </span></p>

<p class=MsoNormal style='margin-left:72.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>//Use the second as the user stack.</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>sz</span></span> = PGROUNDUP(<span class=SpellE>sz</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>е╙╗C<span
class=GramE>╜с</span>╟о╛q╤i╓J╟O╬пеИ</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>(<span class=SpellE>sz</span> = <span class=SpellE>allocuvm</span>(<span
class=SpellE>pgdir</span>, <span class=SpellE>sz</span>, <span class=SpellE>sz</span>
+ 2*PGSIZE)) == 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>clearpteu</span></span><span class=GramE>(</span><span
class=SpellE>pgdir</span>, (char*)(<span class=SpellE>sz</span> &#8722; 2*PGSIZE));</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>sp</span></span> = <span class=SpellE>sz</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
Push argument <span class=GramE>strings,</span> prepare rest of stack in <span
class=SpellE>ustack</span>.</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>for(</span><span class=SpellE>argc</span> = 0; <span class=SpellE>argv</span>[<span
class=SpellE>argc</span>]; <span class=SpellE>argc</span>++) {</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>argc</span> &gt;= MAXARG)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>sp</span></span> = (<span class=SpellE>sp</span>
&#8722; (<span class=SpellE>strlen</span>(<span class=SpellE>argv</span>[<span
class=SpellE>argc</span>]) + 1)) &amp; ~3;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>copyout</span>(<span class=SpellE>pgdir</span>,
<span class=SpellE>sp</span>, <span class=SpellE>argv</span>[<span
class=SpellE>argc</span>], <span class=SpellE>strlen</span>(<span class=SpellE>argv</span>[<span
class=SpellE>argc</span>]) + 1) &lt; 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ustack</span></span><span class=GramE>[</span>3+argc]
= <span class=SpellE>sp</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ustack</span></span><span class=GramE>[</span>3+argc]
= 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ustack</span></span><span class=GramE>[</span>0]
= 0xffffffff; // fake return PC</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ustack</span></span><span class=GramE>[</span>1]
= <span class=SpellE>argc</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ustack</span></span><span class=GramE>[</span>2]
= <span class=SpellE>sp</span> &#8722; (argc+1)*4; // <span class=SpellE>argv</span>
pointer</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>sp</span> &#8722;= (3+argc+1) * 4;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>copyout</span>(<span class=SpellE>pgdir</span>,
<span class=SpellE>sp</span>, <span class=SpellE>ustack</span>, (3+argc+1)*4)
&lt; 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>goto</span></span> bad;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//
</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╛╟╓F</span><span
lang=EN-US>debug</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>юx╕s╣{╕║╕W</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>for(</span>last=s=path; *s; s++)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>*s == ║╕/║╕)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>last</span> = s+1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>safestrcpy</span></span><span class=GramE>(</span><span
class=SpellE>curproc</span>&#8722;&gt;name, last, <span class=SpellE>sizeof</span>(<span
class=SpellE>curproc</span>&#8722;&gt;name));</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// Commit to the
user image.</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>oldpgdir</span></span> = <span class=SpellE>curproc</span>&#8722;&gt;<span
class=SpellE>pgdir</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>curproc</span></span>&#8722;&gt;<span class=SpellE>pgdir</span>
= <span class=SpellE>pgdir</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>curproc</span></span>&#8722;&gt;<span class=SpellE>sz</span>
= <span class=SpellE>sz</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>curproc</span></span>&#8722;&gt;<span class=SpellE>tf</span>&#8722;&gt;<span
class=SpellE>eip</span> = <span class=SpellE>elf.entry</span>; <span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>// main</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>curproc</span></span>&#8722;&gt;<span class=SpellE>tf</span>&#8722;&gt;<span
class=SpellE>esp</span> = <span class=SpellE>sp</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>switchuvm</span>(<span class=SpellE>curproc</span>);<span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//exec</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕w╦к╥s╙╨</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>freevm</span>(<span class=SpellE>oldpgdir</span>);<span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>дю╘Ябб╙╨</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return 0;<span
style='mso-tab-count:5'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕^╤г</span><span
lang=EN-US>0</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>bad:</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>pgdir</span>)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>freevm</span></span><span class=GramE>(</span><span
class=SpellE>pgdir</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>ip</span>){</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>iunlockput</span></span><span class=GramE>(</span><span
class=SpellE>ip</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>end_<span class=GramE>op</span></span><span class=GramE>(</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> &#8722;1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔╕е╙</span><span
lang=EN-US>ELF header</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C</span><span lang=EN-US>Xv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╣w╣wЁQ╢y╜z╪s╙x╗о╔н╙╨</span><span lang=EN-US>ELF format</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║A╘w╦q╕b</span><span
class=SpellE><span lang=EN-US>elf.h</span></span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>║C╓@╜с</span><span lang=EN-US>ELF</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓G╤i╕Л╔]╖t╓@╜с</span><span
lang=EN-US>ELF header</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║B</span><span class=SpellE><span lang=EN-US>struct</span></span><span
lang=EN-US> <span class=SpellE>eldhdr</span>(0955):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>struct</span></span></span><span
lang=EN-US> <span class=SpellE>elfhdr</span> {</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> magic; // must equal
ELF_MAGIC</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uchar</span></span> elf[12];</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> type;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> machine;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> version;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> entry;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>phoff</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>shoff</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> flags;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>ehsize</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>phentsize</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>phnum</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>shentsize</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>shnum</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>ushort</span></span> <span class=SpellE>shstrndx</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>};</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span lang=EN-US>Struct</span></span><span
lang=EN-US> <span class=SpellE><span class=GramE>proghdr</span></span><span
class=GramE>(</span>0974):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>struct</span></span></span><span
lang=EN-US> <span class=SpellE>proghdr</span> {</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> type;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> off;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>vaddr</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>paddr</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>filesz</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>memsz</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> flags;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> align;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>};</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╗C<span
class=GramE>╜с</span></span><span class=SpellE><span lang=EN-US>proghdr</span></span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╢y╜z╓@╛qюЁ╔н╔╡╤╥ЁQе╙╤i╟O╬пеИ║F</span><span
lang=EN-US>xv6</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╣{╕║╫X╔u╕Ё╓@╜с╣{╕║╟о╛q╪пюYюи║A╕Щ╛O╗Д╔L╗t╡н╔i╞Ю╓ю╟t╟о╛q╣╧╚Э╔O╘M╦Й╝ф║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╡д╓@╗B╛O╖жЁtюк╛dюи╝в╔i╞Ю╔]╖t</span><span
lang=EN-US>ELF</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓G╤i╕Л║C╓@╜с</span><span lang=EN-US>ELF</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╓G╤i╕Л╤}╘l╕b</span><span lang=EN-US>4bytes</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>е]ЁN╪ф╕r</span> <span
lang=EN-US>║╔0x7F║╕ , <span class=GramE>║╕</span>E<span class=GramE>║╕</span> , ║╔L║╕
, <span class=GramE>║╕</span>F<span class=GramE>║╕</span> , <span class=GramE>║╕</span>ELF_MAGIC<span
class=GramE>║╕</span>(0952):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>0952 #define ELF_MAGIC 0x464C457FU //
&quot;\x7FELF&quot; in little endian</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕p╙G</span><span
lang=EN-US>ELF</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╪пюYюи╓w╦g╕Ёе]ЁN╪ф╕r║A</span><span lang=EN-US>exec</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╟╡Ё]╓G╤i╕Л╛O╔©╫T╝Ф╕║║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>Loaduvm</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span lang=EN-US>1903):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>loaduvm</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span class=SpellE><span
lang=EN-US>pde_t</span></span><span lang=EN-US> *<span class=SpellE>pgdir</span>,
char *<span class=SpellE>addr</span>, <span class=SpellE>struct</span> <span
class=SpellE>inode</span> *<span class=SpellE>ip</span>, <span class=SpellE>uint</span>
offset, <span class=SpellE>uint</span> <span class=SpellE>sz</span>)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> <span class=SpellE>i</span>,
pa, n;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>pte_t</span> *<span class=SpellE>pte</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>(<span class=SpellE>uint</span>) <span class=SpellE>addr</span>
% PGSIZE != 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>panic(</span>&quot;<span class=SpellE>loaduvm</span>: <span
class=SpellE>addr</span> must be page aligned&quot;);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>for(</span><span class=SpellE>i</span> = 0; <span class=SpellE>i</span>
&lt; <span class=SpellE>sz</span>; <span class=SpellE>i</span> += PGSIZE){</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╔h╢M╖ДЁQ╓ю╟t╙╨╟O╬пеИ╙╨╧ЙеИ╕a╖}║A╪g</span><span
lang=EN-US>ELF</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓Ы╛q╙╨╗C<span class=GramE>╜с</span></span><span lang=EN-US>Page</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>(<span class=SpellE>pte</span> = <span class=SpellE>walkpgdir</span>(<span
class=SpellE>pgdir</span>, a <span class=SpellE>ddr+i</span>, 0)) == 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>panic(</span>&quot;<span class=SpellE>loaduvm</span>: address
should exist&quot;);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>pa</span> = PTE_ADDR(*<span class=SpellE>pte</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>sz</span> &#8722; <span class=SpellE>i</span>
&lt; PGSIZE)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>n
= <span class=SpellE>sz</span> &#8722; <span class=SpellE>i</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>else</span></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>n
= PGSIZE;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>//<span
class=SpellE>readi</span></span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╠qюи╝в╔hе╙</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span><span class=SpellE>readi</span>(<span class=SpellE>ip</span>,
P2V(pa), <span class=SpellE>offset+i</span>, n) != n)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> &#8722;1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Exec</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╓ю╟t╘M╙Л╘l╓ф╗о╔н╙л╟Ое|║C╔╕╓ю╟t╔u╕Ё╓@╜с╟Ое|</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>║C</span><span
lang=EN-US>Exec</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓@╕╦╫ф╩s<span class=GramE>╓@</span>╕r╕Й╟я╪ф╗Л╟Ое|╙╨Ё╩╨щ║A╕b</span><span
class=SpellE><span lang=EN-US>ustack</span></span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╛Ж©Щ╚Э╪п║C╔╕╘Я╓@╜с╙е╚Э╪п╕b</span><span
class=SpellE><span lang=EN-US>argv</span></span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╕C╙М╤г╕V</span><span lang=EN-US>main</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╙╨╖ю╨щ║C╚e╓T<span
class=GramE>╜с</span>╤i╓J</span><span class=SpellE><span lang=EN-US>ustack</span></span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╛O╟╡╙╨╕^╤г</span><span
class=SpellE><span lang=EN-US>PC,argc,argv</span></span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╚Э╪п║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Exec</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╘Я╦m╓@╜с╩╩╩╥╙╨</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕b╟Ое|</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╘Ё╓U║AеЩ<span class=GramE>╣{╕║╣{╕║</span>╔h╗о╔н╓@╜с╔H╓W╙╨</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╥|╔╒╠я║CЁo╜с╩╩╩╥╙╨</span><span
lang=EN-US>page</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>╓]╓╧Ё\</span><span lang=EN-US>exec</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╔hЁB╡z╓с╓j╙╨╟я╪ф║F</span><span class=SpellE><span
class=GramE><span lang=EN-US>copyout</span></span></span><span class=GramE><span
lang=EN-US>(</span></span><span lang=EN-US>2118):</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span class=SpellE><span class=GramE><span lang=EN-US>copyout</span></span></span><span
class=GramE><span lang=EN-US>(</span></span><span class=SpellE><span
lang=EN-US>pde_t</span></span><span lang=EN-US> *<span class=SpellE>pgdir</span>,
<span class=SpellE>uint</span> <span class=SpellE>va</span>, void *p, <span
class=SpellE>uint</span> <span class=SpellE>len</span>)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>{</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>char</span> *<span class=SpellE>buf</span>, *pa0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>uint</span></span> n, va0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE>buf</span> = (char*<span class=GramE>)p</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>while(</span><span class=SpellE>len</span> &gt; 0){</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>va0
= (<span class=SpellE>uint</span><span class=GramE>)PGROUNDDOWN</span>(<span
class=SpellE>va</span>);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>pa0
= <span class=GramE>uva2ka(</span><span class=SpellE>pgdir</span>, (char*)va0);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>pa0 == 0)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> &#8722;1;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>n
= PGSIZE &#8722; (<span class=SpellE><span class=GramE>va</span></span> &#8722; va0);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>if(</span>n &gt; <span class=SpellE>len</span>)</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:3'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>n
= <span class=SpellE>len</span>;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>memmove</span></span><span class=GramE>(</span>pa0
+ (<span class=SpellE>va</span> &#8722; va0), <span class=SpellE>buf</span>, n);</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>len</span></span> &#8722;= n;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>buf</span></span> += n;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:2'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=SpellE><span class=GramE>va</span></span> = va0 + PGSIZE;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;</span><span
style='mso-tab-count:1'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span
class=GramE>return</span> 0;</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>}</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span lang=EN-US>Exec</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╗о╔н╔╕╔h╫ф╩s╟я╪ф╗Л╟Ое|╥|╙`╥N╔ь╙╨╕a</span><span lang=EN-US>page</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓ё╔iЁX╟щ║A╘M╕^╤г</span><span
lang=EN-US>-1</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C</span></p>

<p class=MsoNormal style='text-indent:24.0pt;line-height:16.0pt;mso-line-height-rule:
exactly'><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╕b╥гЁф╥s╙╨╟O╬пеИ<span
class=GramE>╢а╤║║A</span>╕p╙G</span><span lang=EN-US>exec</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>юк╛d╗Л╓@╜с©Ы╩~╧Ё╣L╝д╣{╕║╫X╓Ы╛q║A╔╕╦У╗Л</span><span
lang=EN-US>bad</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║Aдю╘Я╥s╙╨║A╕^╤г</span><span lang=EN-US>-1</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>║C</span><span lang=EN-US>Exec</span><span
style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:
minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;
mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╥|╣╔╚щдю╘Ябб╙╨╙╫╗Л╔╕╫T╘w</span><span
lang=EN-US>system call</span><span style='font-family:"╥s╡с╘ЗеИ","serif";
mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:
╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;
mso-hansi-theme-font:minor-latin'>╥|╕╗╔\║G╕p╙Gбб╙╨бВ╤}╓F║A</span><span lang=EN-US>system
call</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;
mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:
minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:minor-latin'>╓ё╞Ю╕^╤г</span><span
lang=EN-US>-1</span><span style='font-family:"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:
Calibri;mso-ascii-theme-font:minor-latin;mso-fareast-font-family:╥s╡с╘ЗеИ;
mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:Calibri;mso-hansi-theme-font:
minor-latin'>║C╟ъ╓@╙╨©Ы╩~╕b</span><span lang=EN-US>exec</span><span style='font-family:
"╥s╡с╘ЗеИ","serif";mso-ascii-font-family:Calibri;mso-ascii-theme-font:minor-latin;
mso-fareast-font-family:╥s╡с╘ЗеИ;mso-fareast-theme-font:minor-fareast;mso-hansi-font-family:
Calibri;mso-hansi-theme-font:minor-latin'>╣o╔м╕bЁпЁy╙╨╢а╤║║C</span></p>

<p class=MsoNormal style='line-height:16.0pt;mso-line-height-rule:exactly'><span
lang=EN-US><o:p>&nbsp;</o:p></span></p>

</div>

</body>

</html>
